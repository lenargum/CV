---
import '../styles/global.css';
import NoiseBackground from '../components/NoiseBackground';
import { withBasePath } from '../lib/utils';

interface Props {
	title: string;
}

const { title } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="Professional CV">
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href={withBasePath(`favicon.svg`)} />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
	</head>
	<body class="flex justify-center bg-secondary" style="min-height: 100dvh">
		<NoiseBackground client:idle />
		<button
			id="lava-toggle"
			class="print:hidden absolute lg:fixed top-2 left-2 md:right-2 z-[100] shadow-md w-10 h-10 rounded-full overflow-hidden flex items-center justify-center bg-black/80 backdrop-blur-sm active:scale-110 hover:opacity-100 transition-all duration-300 opacity-60"
			aria-label="Toggle lava lamp"
			type="button"
		>
			<img src={withBasePath('lava-lamp.png')} alt="lava-lamp" class="w-3/4 h-3/4 object-cover" />
		</button>
		<main class="w-full max-w-[830px] z-10">
			<slot />
		</main>
	</body>
</html>

<style>
	html {
		height: 100dvh;
		overflow-y: scroll;
	}
	
	@media print {
		body {
			background-color: white !important;
			padding: 0 !important;
			margin: 0 !important;
		}
		main {
			max-width: 100% !important;
			box-shadow: none !important;
		}
	}
</style>

<script>
  const btn = document.getElementById('lava-toggle');
  const updateButton = () => {
    const on = document.body.classList.contains('lava-mode');
    btn?.classList.toggle('opacity-60', !on);
    btn?.classList.toggle('opacity-30', on);
  };
  const toggle = () => {
    document.body.classList.toggle('lava-mode');
    const on = document.body.classList.contains('lava-mode');
    window.dispatchEvent(new CustomEvent('lava-mode-change', { detail: { on } }));
    updateButton();
  };
  btn?.addEventListener('click', toggle);
  // ensure initial state styles
  updateButton();
</script>
